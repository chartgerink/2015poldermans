---
title: "Analyzing DECREASE trials to estimate evidence of data manipulation"
author: '[Chris H. J. Hartgerink](https://orcid.org/0000-0003-1050-6809), E. M. Kemper,
  [Markus W. Hollman](https://orcid.org/0000-0001-8248-0244), [Gerben ter Riet](https://orcid.org/0000-0002-2231-7637)'
date: '`r format(Sys.time(), "%d %B, %Y")`'
output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
  html_document: default
  word_document: default
csl: ../bibliography/ama.csl
bibliography: ../bibliography/library.bib
---

# Abstract

The effect of beta-blockers on perioperative mortality in non-cardiac surgery has been controversial due to concerns regarding the scientific integrity of the DECREASE-I and DECREASE-IV trials. In this report, we investigate these DECREASE trials and model their veracity (i.e., the probability that these effects or more extreme occurred naturally) and estimate how many data points might have been manipulated in the DECREASE trials. Our research indicates that the DECREASE trials are nearly impossible if we assume they investigate the same effect as the non-DECREASE trials and under that assumption, our results provide evidence that at least some data points were manipulated. However, these differences might also be due to different conceptual approaches as to how beta-blockade might prevent mortality in non-cardiac surgery. Considering this, we recommend new and more extensively controlled, confirmatory trials to determine whether there is any use in administering beta-blockers in order to decrease perioperative mortality.

# Author note

All manuscript materials are available at https://github.com/chartgerink/2015poldermans and are preserved at Zenodo ([doi.org/10.5281/zenodo.845354](https://doi.org/10.5281/zenodo.845354)). CHJH was funded by the Office of Research Integrity during part of this project (ORI; ORIIR160019).

```{r, echo = FALSE}
tabnr <- 1
fignr <- 1
```

# Introduction

The effect of beta-blockers on perioperative mortality in non-cardiac surgery has been controversial [@Coleg5210] due to concerns regarding the  scientific integrity in two related clinical trials [@poldermans1999;@dunkelgrun2009;@commissie2011;@commissie2012;@commissie2013]. Three meta-analyses that included the trials subject to concerns concluded that beta-blockers decrease perioperative mortality [@Devereaux313;@Angeli2010;@bouri2014] whereas a meta-analysis that excluded the suspect trials concluded that beta-blockers increase perioperative mortality [@bouri2014]. In these studies, perioperative mortality was defined as the death rate of patients in the perioperative setting, including the period of admission, anaesthesia with surgery, and postoperative recovery. 

The trials subject to concerns regarding scientific integrity were the Dutch DECREASE-I and DECREASE-IV trials [@commissie2011;@commissie2012;@commissie2013]. The committees that investigated the integrity of the DECREASE trials reported that data manipulation was likely but that the extent of the data manipulation remained unclear [@commissie2011;@commissie2012;@commissie2013]. Moreover, the latest guidelines still recommend the usage of beta-blockers in the perioperative period in certain cases [@esc2014;@Fleisher_2014], where some of these guidelines are based on other work by the PI of the DECREASE trials. Considering the potential harmful consequences of guidelines based on work by someone who has been repeatedly investigated for breaching scientific integrity, we aim to estimate the extent of data manipulation in the DECREASE studies [@poldermans1999;@dunkelgrun2009;@commissie2011;@commissie2012;@commissie2013] to further stimulate the debate on using beta-blockers in the perioperative period for patients undergoing non-cardiac surgery.

The reports on the integrity of the DECREASE trials primarily focused on the provenance of the raw data but did not investigate the extent to which the DECREASE trials deviated from comparable trials. Provenance is primarily concerned with the origins of the data, verifying things such as (but not limited to) the informed consent and whether data corresponded to patient files. The committee reports did not neglect statistical evaluation however: according to the report a statistical expert evaluated the applicability of forensic statistical methods [@commissie2013] to evaluate results of trials separately (i.e., DECREASE-I, DECREASE-IV) although the report lacks details as to how this evaluation took place. The expert concluded that the previously applied methods by him were not applicable for use in this case. Nonetheless, in this report we compare across trials, which is a method that has previously been used to monitor trial data quality or to test for potential data anomalies [@Buyse1999-jq;@10.1111/anae.13938]. Moreover, comparing across trials instead of evaluating them separately has previously proven to be effective in detecting data manipulation [@Knepper2016-la]. Comparing the DECREASE trials to other published trials studying the effectiveness of beta-blockers with respect to perioperative mortality could prove informative of the potential extent of the manipulation in the DECREASE trials.

The effectiveness of perioperative beta-blockade is obfuscated by the afflicted DECREASE trials, potentially interacting with the type of beta-blocker and the way that beta-blockers were administered (i.e., dose and duration of treatment). In the randomized trials on beta-blockers, patients were administered various types of beta-blockers (e.g., metroprolol, bisoprolol, atenolol) and in various ways (e.g., intravenously, orally; half an hour before surgery or multiple days before surgery; with or without titration based on heart rate). Factors such as dosage and duration can have an effect on the pharmacological effectiveness with respect to perioperative mortality. Moreover, the highly discrepant results from the DECREASE trials [@bouri2014] might partly be caused by such differences [@klei2015] and not purely due to data manipulation (given that not all data points can be considered manipulated at this point).

To statistically investigate the evidence for data manipulation in the DECREASE studies [@dunkelgrun2009;@poldermans1999], we took three steps. 
First, we reproduced the findings from the 2014 meta-analysis by Bouri et al. [@bouri2014], which contained sufficient information to estimate the deviation of the DECREASE trials from other published trials on beta-blockers. We also included type of beta-blocker to inspect whether this is predictive of the effect of beta-blockers on perioperative mortality. 
Second, we evaluated the probability that the DECREASE trials (or more extreme effects) arose from the same effect distribution as the non-DECREASE trials, which are assumed to be the true effect of beta-blockers on perioperative mortality in patients undergoing non-cardiac surgery. 
Third, we estimated how many data points would have to be manipulated in order to reproduce the results of the DECREASE trials if the initial, non-manipulated results arose from the effect estimates as obtained from the non-DECREASE trials. Considering the committees investigating the scientific integrity of the DECREASE trials were unable to assess this, we consider it worthwhile to investigate this further.

## Step 1: reproducing meta-analysis of Bouri et al. (2014)

### Methods

To ensure that we used similar analysis procedures as in the 2014 meta-analysis [@bouri2014], we initially reproduced Bouri et al.'s estimates. This ensured that (1) their results are reproducible and (2) we are using the correct estimates in subsequent steps of our analyses. Using figures 2 and 3 from the original paper [@bouri2014], we extracted the raw event data for the 2 (control vs experimental) by 2 (event vs no event) design, which we used to recompute the natural logarithm of the risk ratio and its standard error. The extracted event data is available at [osf.io/aykeh](https://osf.io/aykeh) and our analysis plan was preregistered at [osf.io/vnmzc](https://osf.io/vnmzc).

```{r, echo = FALSE}
options(scipen = 5)
suppressPackageStartupMessages(if(!require(metafor)){install.packages('metafor', repos = "http://cran.us.r-project.org")})
suppressPackageStartupMessages(library(metafor))
suppressPackageStartupMessages(if(!require(latex2exp)){install.packages('latex2exp', repos = "http://cran.us.r-project.org")})
suppressPackageStartupMessages(library(latex2exp))
suppressPackageStartupMessages(library(knitr))

x12 <- '../'
# x12 <- ''
bouri_data <- read.csv(sprintf('%sdata/bouri_data.csv', x12))

bouri_data$a <- bouri_data$control_n - bouri_data$control_events
bouri_data$b <- bouri_data$beta_n - bouri_data$beta_events
bouri_data$c <- bouri_data$control_events
bouri_data$d <- bouri_data$beta_event

bouri_data$beta_blocker <- c("atenolol",
                             "propranolol",
                             "metoprolol",
                             "metoprolol",
                             "metoprolol",
                             "atenolol",
                             "bisoprolol",
                             "metoprolol",
                             "metoprolol",
                             "bisoprolol",
                             "bisoprolol")

# Add .5 to all studies to correct for zero-counts
bouri_data[, 7:10] <-  bouri_data[, 7:10] + .5

bouri_data$ln_rr <- log((bouri_data$d/(bouri_data$b+bouri_data$d))/(bouri_data$c/(bouri_data$a+bouri_data$c)))
bouri_data$se_ln_rr <- sqrt((1/bouri_data$a)+(1/bouri_data$b)+(1/bouri_data$c)+(1/bouri_data$d))

mod_clean <- metafor::rma(yi = ln_rr,
                          sei = se_ln_rr,
                          method = "REML",
                          data = bouri_data[bouri_data$decrease == 0, ],
                          weighted = TRUE)
mod_dirty <- metafor::rma(yi = ln_rr,
                          sei = se_ln_rr,
                          method = "REML",
                          data = bouri_data[bouri_data$decrease == 1, ],
                          weighted = TRUE)
```

We computed the log risk ratio (i.e., log RR) for each study and pooled these using `v2.0.0` of the `R` package `metafor` [@viechtbauer2010]. We estimated a weighted random-effects model using the restricted maximum-likelihood estimator (i.e., `REML`) [@viechtbauer2005] to estimate the variance of effects. We used the default weighting procedure in the `metafor` package. We added 0.5 to each cell count, as is common in meta-analyses on risk- and odds ratios in order to prevent computational artefacts [@agresti2002]. <!--p397-->
The 2014 meta-analysis [@bouri2014] did not specify the variance estimate used, hence, (minor) discrepancies between our estimates and the original estimates could be due to differences in the estimation procedure.

### Results

We were able to closely reproduce the estimates for the different sets of studies (Figure 2 of the 2014 meta-analysis [@bouri2014]). Bouri et al. differentiated between the estimates from the non-DECREASE trials ($k=`r sum(bouri_data$decrease == 0)`$) and the DECREASE trials ($k=`r sum(bouri_data$decrease == 1)`$). We confirmed the effect size estimates and the variance estimates for both the non-DECREASE- and the DECREASE trials, except for some discrepancies at the second decimal level for the estimated effect sizes and a somewhat larger difference between the variance estimates of the DECREASE studies. Table `r tabnr` depicts the original and reproduced values for both sets of studies.

```{r echo=FALSE,results='asis'}
table1 <- matrix('', ncol = 5, nrow = 5)
table1[1,3] <- 'Risk ratio'
table1[1,5] <- '$\\tau^2$'
table1[1,4] <- 'RR Confidence interval'
table1[2,1] <- 'Non-DECREASE (k=9)'
table1[4,1] <- 'DECREASE (k=2)'
table1[c(2,4),2] <- 'Original'
table1[c(3,5),2] <- 'Reproduced'
table1[2,3] <- 1.27
table1[2,5] <- 0.00
table1[2,4] <- '[1.01; 1.60]'

table1[3,3] <- round(exp(mod_clean$b), 2)
table1[3,5] <- round(mod_clean$tau2, 2)
table1[3,4] <- sprintf('[%s; %s]', round(exp(mod_clean$ci.lb), 2), round(exp(mod_clean$ci.ub), 2))

table1[4,3] <- 0.42
table1[4,5] <- 0.29
table1[4,4] <- '[0.15; 1.23]'

table1[5,3] <- round(exp(mod_dirty$b), 2)
table1[5,5] <- round(mod_dirty$tau2, 2)
table1[5,4] <- sprintf('[%s; %s]', round(exp(mod_dirty$ci.lb), 2), round(exp(mod_dirty$ci.ub), 2))


knitr::kable(table1, caption = 'The original- and reproduced meta-analytic results based on the data provided in the 2014 meta-analysis by Bouri et al.')

tabnr <- tabnr + 1
```

```{r, echo = FALSE}
mod_mods <- metafor::rma(yi = ln_rr,
                         sei = se_ln_rr,
                         mod =~ as.factor(decrease), # 1 are the decrease studies
                         method = "REML",
                         data = bouri_data,
                         weighted = TRUE)

i2_mods <- mod_mods$I2
```

Second, we meta-analyzed all studies combined, including a dummy predictor for the DECREASE and non-DECREASE studies to reproduce results presented in Figure 4 of the 2014 meta-analysis [@bouri2014]. Our results showed a bit more evidence against equal subgroups than the original meta-analysis [@bouri2014] (original: $\chi^2(1)=3.91,p=.05$; reproduced: $\chi^2(1)=`r round(mod_mods$QM, 2)`,p=`r round(mod_mods$QMp, 3)`$). Additionally, the original analyses showed substantial residual heterogeneity ($I^2=74.4$\%) whereas we found no residual heterogeneity ($I^2=`r round(i2_mods, 3)`$\%). Different variance estimates (e.g., `DerSimonian-Laird` instead of `REML`) did not resolve this difference. We tried to clarify these discrepancies by e-mailing the original authors (including a reminder after several weeks) but did not receive a response. Nonetheless, the broad strokes of the meta-regression confirmed that the DECREASE trials were the determining predictor for the effectiveness of beta-blockers (including DECREASE: $RR=`r round(exp(mod_mods$b[1] + mod_mods$b[2]), 3)`$; excluding DECREASE: $RR=`r round(exp(mod_mods$b[1]), 3)`$).
<!--- Emailed bouri about this on 2016 03 16 -->

```{r, echo = FALSE}
mod_mods_type <- metafor::rma(yi = ln_rr,
                         sei = se_ln_rr,
                         mod =~ as.factor(decrease) + as.factor(beta_blocker),
                         method = "REML",
                         data = bouri_data,
                         weighted = TRUE)
```

Additionally, and exploratively, we evaluated the predictive effect of the type of beta-blocker used in the trials. Descriptively, the DECREASE trials remained predictive of decreased mortality ($RR=`r round(exp(mod_mods_type$b[1] + mod_mods_type$b[2] + mod_mods_type$b[3]), 3)`$), <!-- DECREASE only uses bisoprolol! -->
whereas the non-DECREASE trials provide tentative evidence that atenolol results in lower mortality ($RR=`r round(exp(mod_mods_type$b[1]), 3)`$). Nonetheless, for other beta-blockers in the non-DECREASE trials, there is descriptive evidence that beta-blockers could increase mortality (bisoprolol: $RR=`r round(exp(mod_mods_type$b[1] + mod_mods_type$b[3]), 3)`$; metoprolol: $RR=`r round(exp(mod_mods_type$b[1] + mod_mods_type$b[4]), 3)`$; propranolol: $RR=`r round(exp(mod_mods_type$b[1] + mod_mods_type$b[5]), 3)`$). Table `r tabnr` shows the meta-regression results in full. We do note that the DECREASE studies only use bisoprolol and any estimates for other beta-blockers are extrapolations.

```{r echo = FALSE}
table3 <- matrix(NA, nrow = 8, ncol = 3)
table3[1,1] <- ''
table3[2,1] <- 'Intercept'
table3[3,1] <- 'Non-DECREASE'
table3[4,1] <- 'DECREASE'
table3[5,1] <- 'Atenolol'
table3[6,1] <- 'Bisoprolol'
table3[7,1] <- 'Metoprolol'
table3[8,1] <- 'Propranolol'

table3[1,2] <- 'Estimate'
table3[2,2] <- round(mod_mods_type$b[1], 3)
table3[3,2] <- '-'
table3[4,2] <- round(mod_mods_type$b[2], 3)
table3[5,2] <- '-'
table3[6,2] <- round(mod_mods_type$b[3], 3)
table3[7,2] <- round(mod_mods_type$b[4], 3)
table3[8,2] <- round(mod_mods_type$b[5], 3)

table3[1,3] <- '95% CI'
table3[2,3] <- sprintf('%s; %s', round(mod_mods_type$ci.lb[1], 3),
                       round(mod_mods_type$ci.ub[1], 3))
table3[3,3] <- '-'
table3[4,3] <- sprintf('%s; %s', round(mod_mods_type$ci.lb[2], 3),
                       round(mod_mods_type$ci.ub[2], 3))
table3[5,3] <- '-'
table3[6,3] <- sprintf('%s; %s', round(mod_mods_type$ci.lb[3], 3),
                       round(mod_mods_type$ci.ub[3], 3))
table3[7,3] <- sprintf('%s; %s', round(mod_mods_type$ci.lb[4], 3),
                       round(mod_mods_type$ci.ub[4], 3))
table3[8,3] <- sprintf('%s; %s', round(mod_mods_type$ci.lb[5], 3),
                       round(mod_mods_type$ci.ub[5], 3))


knitr::kable(table3, caption = 'Meta-regression results (k=11) for log(RR), including dummy predictors for DECREASE trials (reference: non-DECREASE trials) and type of beta-blockers used in the trial (reference: atenolol).')
tabnr <- tabnr + 1
```

## Step 2: evaluating the veracity of DECREASE studies

Based on the effect estimates for the non-DECREASE trials from Step 1, we estimated the probability that the observed effects from the DECREASE studies (or more extreme) occurred naturally. We assumed that the non-DECREASE studies estimated the true effect distribution of perioperative beta-blockade on mortality, not perturbed by publication bias due to statistical (non)significance. Publication bias was assumed to not be a problem because a substantial number of nonsignificant effects are included in the dataset (9 of 11 results are nonsignificant). Based on this effect distribution, we estimated the veracity of the DECREASE trials separately, which is the estimated probability of the observed data (or more extreme) under a given true effect [@peters2015]. We note that this is primarily aimed to quantify the suspected difference between the DECREASE and non-DECREASE trials.

### Method

```{r, echo = FALSE}
mod_clean_pred <- predict(mod_clean)
mod_dirty_pred <- predict(mod_dirty)

var1 <- mod_clean_pred$se^2 / sum(bouri_data$decrease == 0)
var_decrI <- (bouri_data$se_ln_rr[bouri_data$decrease == 1][1]^2 / sum(bouri_data$decrease == 0))
var_decrIV <- (bouri_data$se_ln_rr[bouri_data$decrease == 1][2]^2 / sum(bouri_data$decrease == 0))
decrI <- bouri_data$ln_rr[bouri_data$decrease == 1][1]
decrIV <- bouri_data$ln_rr[bouri_data$decrease == 1][2]
mu_ma <- mod_clean_pred$pred

df_I <- 1 + 9 - 2
t_I <- (decrI - mu_ma) / sqrt(var1 + var_decrI)
p_I <- pt(abs(t_I), df = df_I, lower.tail = FALSE) * 2

df_IV <- 1 + 9 - 2
t_IV <- (decrIV - mu_ma) / sqrt(var1 + var_decrIV)
p_IV <- pt(abs(t_IV), df = df_IV, lower.tail = FALSE) * 2
```

Based on the estimated effect distribution from the non-DECREASE trials, we calculated the probability of each DECREASE trial result, or a more extreme result. In other words, we computed the two-tailed $p$-value for the null hypothesis that the DECREASE trials arose from the same effect distribution as the non-DECREASE trials ($H_0:\mu_{\bar{x}_1-\bar{x}_2}=0$). To this end, we applied a Welch t-test [@doi:10.1093/biomet/34.1-2.28]. 
As means we used the observed log RR for the DECREASE trials (i.e., DECREASE-I: `r round(decrI, 3)`; DECREASE-IV: `r round(decrIV, 3)`) and the meta-analyzed log RR for the non-DECREASE trials (i.e., `r round(mu_ma, 3)`). 
As standard deviations we used the standard error for the DECREASE trials (i.e., DECREASE-I: `r round(var_decrI, 3)`; DECREASE-IV: `r round(var_decrIV, 3)`) and the standard error of the estimated log RR for the non-DECREASE trials (i.e., `r round(var1, 3)`). We initially preregistered that the DECREASE trials would be regarded as fixed in the computation of the veracity, which was erroneous because these also have their own standard error; hence, we applied the Welch test to take into account the uncertainty in the estimates of both the DECREASE and non-DECREASE trials.

### Results

```{r, echo = FALSE}
prob <- pnorm(q = bouri_data$ln_rr[bouri_data$decrease == 1],
              mod_clean_pred$pred,
              (mod_clean_pred$pred - mod_clean_pred$cr.lb)/1.96) * 2

zval <- (bouri_data$ln_rr[bouri_data$decrease == 1] - mod_clean_pred$pred) / ((mod_clean_pred$pred - mod_clean_pred$cr.lb)/1.96)
```

Results indicate that the DECREASE trials are highly unlikely under the estimated effect distribution from the non-DECREASE trials. More specifically, the results from DECREASE-I (or more extreme) have a probability of 1 in 10 000 ($t(`r df_I`)=`r round(t_I, 3)`,p=`r p_I`$) and the results from DECREASE-IV (or more extreme) have a probability of 1 in 1000 ($t(`r df_IV`)=`r round(t_IV, 3)`,p=`r p_IV`$). This indicates that the DECREASE trial results are unlikely to have come from the same population effect distribution as the non-DECREASE trials. Moreover, observing two of such extremely unlikely results jointly, as in the DECREASE trials, would occur in only 2 out of 10 million sets of two trials (i.e., $`r p_I*p_IV`$) according to this model. Hence, this result indicates that the DECREASE trials are severely different from the non-DECREASE trials.

Results from Step 1 indicated that no between-trial variance (i.e., homogeneity; $\tau^2=0$) of the effects was observed; given the small number of trials included (i.e., `r mod_clean$k`) this estimate is highly uncertain, however. The total $N$ across the non-DECREASE trials was `r sum(bouri_data$control_n[bouri_data$decrease == 0] + bouri_data$beta_n[bouri_data$decrease == 0])`. We conducted sensitivity analyses to see how dependent results are on the heterogeneity estimate (not preregistered; [osf.io/vnmzc](https://osf.io/vnmzc)). Fixing the variance estimate $\tau^2$ to .5, indicates that the probability of observing the DECREASE trials jointly is approximately 1.2 out of 100 000 (see Figure `r fignr`). To put these numbers into context, a variance of 0.25 would suggest that results of perioperative beta-blockade vary substantially due to contextual circumstances of the study, even if perioperative beta-blockade has no effect whatsoever (RRs between `r round(exp(0 - .25), 3)` and `r round(exp(0 + .25), 3)` in ~64\% of the cases).

```{r, echo = FALSE}
pdf(sprintf('%sfigures/fig1.pdf', x12), width = 8, height = 6)
tau2 <- seq(0, .5, .01)

prob_sens_t <- NULL
i <- 1

for (t2 in tau2){
  mod_clean_sens <- metafor::rma(yi = ln_rr,
                                 sei = se_ln_rr, tau2 = t2,
                                 method = "REML",
                                 data = bouri_data[bouri_data$decrease == 0, ],
                                 weighted = TRUE)
  mod_clean_pred_sens <- predict(mod_clean_sens)
  
  var1 <- mod_clean_pred_sens$se^2 / sum(bouri_data$decrease == 0)
  mu_ma <- mod_clean_pred_sens$pred
  
  df_I <- 1 + 9 - 2
  t_I <- (decrI - mu_ma) / sqrt(var1 + var_decrI)
  p_I <- pt(abs(t_I), df = df_I, lower.tail = FALSE) * 2
  
  df_IV <- 1 + 9 - 2
  t_IV <- (decrIV - mu_ma) / sqrt(var1 + var_decrIV)
  p_IV <- pt(abs(t_IV), df = df_IV, lower.tail = FALSE) * 2
  prob_sens_t[i] <- p_I* p_IV
  
  i <- i + 1
}

par(mar = c(4, 4, 1, 0))
plot(tau2, prob_sens_t, type = 'l', xlab = TeX('$\\tau^2$'),
     ylab = 'p-value', bty = 'n')
# points(x = tau2[c(26, 44)], y = prob_sens_t[c(26, 44)])
# text(x = tau2[c(26, 44)],
#      y = prob_sens_t[c(26, 44)] + .003,
#      labels = c(TeX('$\\tau^2=.25$'), TeX('$\\tau^2=.43$')),
#      cex = .8)
invisible(dev.off())
```
```{r figure 2, fig.cap = 'Sensitivity analyses for the p-value that indicates the probability of observing the results from the DECREASE studies, or more extreme results, based on the estimated true effect (non-DECREASE trials) and the accompanying variance estimate.', out.width = '80%', fig.asp = .5, fig.align = 'center', echo = FALSE}
knitr::include_graphics(sprintf("%sfigures/fig1.pdf", x12))
fignr <- fignr + 1
```

## Step 3: estimating the amount of manipulated data

```{r echo = FALSE}
# This is for easy reference
# And to easily include in text
iterations <- 10000
```
We estimated the number of data points that would need to be manipulated to arrive at the estimates from the DECREASE trials, given that the non-DECREASE trials represent the true effect of perioperative beta-blockade. In contrast to Step 2, which assumes no data manipulation occurred and that the DECREASE trials occurred naturally from the same effect distribution as the non-DECREASE trials, Step 3 assumes that the DECREASE trials might in fact contain manipulated data. The estimates from Step 3 provide an indication of the extent of potential data manipulation in the DECREASE studies [@commissie2011;@commissie2012;@commissie2013;@bouri2014].

### Method

In order to estimate the number of manipulated data points, we first estimated the probability of perioperative mortality (in log odds) in each trial arm for each trail stratum. As such, we estimate mortality odds four times: once per condition (beta-blocker or control) per trial stratum (DECREASE- and non-DECREASE trials). For all four combinations of condition and trial type, we ran a meta-analysis applying similar methods used in Step 1, resulting in four meta-analytic absolute mortality estimates with corresponding effect variances. Throughout the simulations, we used the point estimates (i.e., fixed effect) to simulate genuine- and manipulated data, but supplemented this by using distribution estimates (i.e., random effects) as sensitivity analyses.

We applied the inversion method to estimate the number of manipulated data points in the DECREASE trials [@casella2002]. We assumed that if data are manipulated, each data point is manipulated in the same way and to the same extent. The inversion method iteratively hypothesizes that *X* out of *N* data points were manipulated (i.e., $X={0, 1, ..., N}$), assuming they were manipulated in the same way. For each combination of *X* and trial, we simulated `r iterations` datasets. Each simulated dataset contained *X* manipulated data points and *N-X* genuine data points. For each simulated dataset (exact simulation procedure in the next paragraph), we determined the likelihood of the results with 
$$
L(\theta|\pi_{E},\pi_{C})=\pi_{E}^{n_{11}}(1-\pi_{E})^{n_{12}} \times \pi_{C}^{n_{21}}(1 - \pi_{C})^{n_{22}}
$$
where $\pi_{E}$ indicates the mortality rate in the beta-blocker condition as drawn from the meta-analytic effect distribution ($\pi_{C}$ indicates the mortality rate in the control condition). We estimated those parameters using the meta-analytic procedure described in the previous paragraph, resulting in the estimates depicted in Table `r tabnr`. The likelihood was computed under both the manipulated effect estimates (i.e., $L_{manipulated}$) and the genuine data (i.e., $L_{genuine}$). Table 4 indicates which cell sizes the various $n_{XX}$ refer to within the (simulated) data. After computing the likelihoods, we compared them to determine whether the simulated data were more likely to arise from the genuine trials ($L_{genuine}>L_{manipulated}$) or from the manipulated trials ($L_{manipulated}>L_{genuine}$). Note that comparing the likelihoods is a minor deviation from the preregistration, where we initially planned on using $p$-value comparisons ([osf.io/vnmzc](https://osf.io/vnmzc)).


```{r, echo = FALSE}
# Log odds for control conditions
numerator <- bouri_data$c/(bouri_data$a + bouri_data$c)
denominator <- 1 - (bouri_data$c / (bouri_data$a + bouri_data$c))
bouri_data$ln_odds_cont <- log(numerator / denominator)

bouri_data$se_ln_odds_cont <- 1 / ((bouri_data$a + bouri_data$c) * 
                                     (bouri_data$c / (bouri_data$a + bouri_data$c)) *
                                     (1 - (bouri_data$c / (bouri_data$a + bouri_data$c))))

# Log odds for beta-blocker conditions
numerator <- bouri_data$d/(bouri_data$b + bouri_data$d)
denominator <- 1 - (bouri_data$d / (bouri_data$b + bouri_data$d))
bouri_data$ln_odds_beta <- log(numerator / denominator)

bouri_data$se_ln_odds_beta <- 1 / ((bouri_data$b + bouri_data$d) * 
                                     (bouri_data$d / (bouri_data$b + bouri_data$d)) *
                                     (1 - (bouri_data$d / (bouri_data$b + bouri_data$d))))

mod_cont <- rma(yi = ln_odds_cont,
                sei = se_ln_odds_cont,
                data = bouri_data[bouri_data$decrease == 0, ],
                method = 'REML',
                weighted = TRUE)
mod_beta <- rma(yi = ln_odds_beta,
                sei = se_ln_odds_beta,
                data = bouri_data[bouri_data$decrease == 0, ],
                method = 'REML',
                weighted = TRUE)

mod_cont_decrease <- rma(yi = ln_odds_cont,
                         sei = se_ln_odds_cont,
                         data = bouri_data[bouri_data$decrease == 1, ],
                         method = 'REML',
                         weighted = TRUE)
mod_beta_decrease <- rma(yi = ln_odds_beta,
                         sei = se_ln_odds_beta,
                         data = bouri_data[bouri_data$decrease == 1, ],
                         method = 'REML',
                         weighted = TRUE)

cont_pred <- predict(mod_cont)$pred
cont_cr_lb <- predict(mod_cont)$cr.lb
cont_cr_ub <- predict(mod_cont)$cr.ub
cont_var <- (cont_pred - cont_cr_lb) / 1.96

beta_pred <- predict(mod_beta)$pred
beta_cr_lb <- predict(mod_beta)$cr.lb
beta_cr_ub <- predict(mod_beta)$cr.ub
beta_var <- (beta_pred - beta_cr_lb) / 1.96

cont_decrease_pred <- predict(mod_cont_decrease)$pred
cont_decrease_cr_lb <- predict(mod_cont_decrease)$cr.lb
cont_decrease_cr_ub <- predict(mod_cont_decrease)$cr.ub
cont_decrease_var <- (cont_decrease_pred - cont_decrease_cr_lb) / 1.96

beta_decrease_pred <- predict(mod_beta_decrease)$pred
beta_decrease_cr_lb <- predict(mod_beta_decrease)$cr.lb
beta_decrease_cr_ub <- predict(mod_beta_decrease)$cr.ub
beta_decrease_var <- (beta_decrease_pred - beta_decrease_cr_lb) / 1.96

table22 <- matrix('', ncol = 4, nrow = 5)
table22[1,1] <- ''
table22[1,2] <- ''
table22[1,3] <- 'log(odds)'
table22[1,4] <- "$\\tau$"

table22[2,1] <- 'DECREASE (k=2)'
table22[2,2] <- 'Beta-blocker'
table22[2,3] <- round(beta_decrease_pred, 3)
table22[2,4] <- round(beta_decrease_var, 3)

table22[3,1] <- ''
table22[3,2] <- 'Control'
table22[3,3] <- round(cont_decrease_pred, 3)
table22[3,4] <- round(cont_decrease_var, 3)

table22[4,1] <- 'Non-DECREASE (k=9)'
table22[4,2] <- 'Beta-blocker'
table22[4,3] <- round(beta_pred, 3)
table22[4,4] <- round(beta_var, 3)

table22[5,1] <- ''
table22[5,2] <- 'Control'
table22[5,3] <- round(cont_pred, 3)
table22[5,4] <- round(cont_var, 3)


knitr::kable(table22, caption = "Mortality estimates per condition, per trial stratum. We used these parameters to estimate the number of manipulated data points with the inversion method.")

```


```{r echo=FALSE, results='asis'}
table2 <- matrix('', ncol = 3, nrow = 3)
table2[1,1] <- ''
table2[1,2] <- 'Dead'
tabnr <- tabnr + 1
table2[1,3] <- 'Alive'

table2[2,1] <- 'Beta-blockers'
table2[2,2] <- '$n_{11}$'
table2[2,3] <- '$n_{12}$'

table2[3,1] <- 'Control'
table2[3,2] <- '$n_{21}$'
table2[3,3] <- '$n_{22}$'

knitr::kable(table2, caption = 'Outcome possibilities within a simulated 2 (beta-blocker v control) by 2 (dead v alive) clinical trial.')

tabnr <- tabnr + 1
```

For each hypothesis of *X* out of *N* manipulated data points, we computed the probability that the manipulated data are more likely than the genuine data ($p_M=P(L_{manipulated}>L_{genuine})$). Based on $p_M$, we computed the confidence interval for the estimated $X$ manipulated data points (i.e., $X_{LB};X_{UB}$). For a 95\% confidence interval, the lower bound is equal to the $p_M$ closest to .025, whereas the upperbound is equal to the $p_M$ closest to .975.

We computed $p_M$ for all *X* out of *N* manipulated data points in `r iterations` randomly generated datasets, which were generated in three steps. For each dataset we: 

1. Sampled (across conditions, without replacement) *X* fictitious participants that would be the result of data manipulation. 

2. Determined the population mortality rate for each condition (i.e., for each cell based on the estimates from Table 3). The meta-analytic point estimate was used or a population effect was randomly drawn from the meta-analytic effect distribution.

3. Simulated the number of deaths for the different conditions using a binomial distribution based on the mortality rate as determined in 2, resulting in the cell counts as in Table 3.

Based on the meta-analytic effect from 2 and the cell sizes from 3, we computed the likelihoods $L_{manipulated}$ and $L_{genuine}$ using Equation 1. As mentioned before, we computed $p_M$, which indicates the probability that the data are more likely under the estimates resulting from the (allegedly) manipulated data (i.e., the DECREASE trials) than under the estimates resulting from the genuine data (i.e., the non-DECREASE trials; $p_M=P(L_{manipulated}>L_{genuine})$).

### Results

```{r, echo = FALSE}
# Uncomment if you want to rerun the inversion method
# > t1
# [1] "2016-03-29 13:34:31 CEST"
# > t2
# [1] "2016-03-29 15:55:27 CEST"
# t1 <- Sys.time()
# set.seed(123)
# source('../functions/inversion_method_uncertain.R')
# # source('functions/inversion_method_uncertain.R')
# t2 <- Sys.time()
# set.seed(123)
# source('../functions/inversion_method_certain.R')
# # source('functions/inversion_method_certain.R')
# t3 <- Sys.time()

load('../data/result_almost_i_uncertain')
load('../data/result_almost_i_certain')

load('../data/result_almost_iv_uncertain')
load('../data/result_almost_iv_certain')

# load('data/result_almost_i_uncertain')
# load('data/result_almost_i_certain')
# 
# load('data/result_almost_iv_uncertain')
# load('data/result_almost_iv_certain')

res_i_uncertain <- result_almost_i_uncertain / iterations
res_i_certain <- result_almost_i_certain / iterations
  
res_iv_uncertain <- result_almost_iv_uncertain / iterations
res_iv_certain <- result_almost_iv_certain / iterations

res_i_uncertain_lb <- NULL
res_i_uncertain_ub <- NULL
res_i_certain_lb <- NULL
res_i_certain_ub <- NULL

res_iv_uncertain_lb <- NULL
res_iv_uncertain_ub <- NULL
res_iv_certain_lb <- NULL
res_iv_certain_ub <- NULL

j <- 1
for (i in seq(0, 1, .01))
{
  lb <- .5 - (i / 2)
  ub <- .5 + (i / 2)
  
  # MINUS ONE because R does not have zero indexing
  # AAAA
  res_i_uncertain_lb[j] <- which(abs(res_i_uncertain - lb) == min(abs(res_i_uncertain - lb)))[1] - 1
  res_i_uncertain_ub[j] <- which(abs(res_i_uncertain - ub) == min(abs(res_i_uncertain - ub)))[1] - 1
  
  
  res_i_certain_lb[j] <- which(abs(res_i_certain - lb) == min(abs(res_i_certain - lb)))[1] - 1
  res_i_certain_ub[j] <- which(abs(res_i_certain - ub) == min(abs(res_i_certain - ub)))[1] - 1
  
  
  res_iv_uncertain_lb[j] <- which(abs(res_iv_uncertain - lb) == min(abs(res_iv_uncertain - lb)))[1] - 1
  res_iv_uncertain_ub[j] <- which(abs(res_iv_uncertain - ub) == min(abs(res_iv_uncertain - ub)))[1] - 1
  
  res_iv_certain_lb[j] <- which(abs(res_iv_certain - lb) == min(abs(res_iv_certain - lb)))[1] - 1
  res_iv_certain_ub[j] <- which(abs(res_iv_certain - ub) == min(abs(res_iv_certain - ub)))[1] - 1
  
  
  j <- j + 1
}

N_I <- sum(bouri_data[grepl(bouri_data$study, pattern = '_I-'),c(3,5)])
N_IV <- sum(bouri_data[grepl(bouri_data$study, pattern = '_IV-'),c(3,5)])

pdf(sprintf('%sfigures/fig2.pdf', x12), width = 8, height = 6)

par(mar = c(5, 5, 2.5, 0),
    mfrow = c(2, 2))
plot(res_i_uncertain,
     xlab = 'Number of data points manipulated',
     ylab = 'Proportion',
     main = 'DECREASE-I',
     ylim = 0:1,
     type = 'l',
     lty = 1)
lines(res_i_certain, pch = 2, type = 'l', lty = 2)
abline(h = c(.025, .975), lty = 3)

legend(x = 0, y = .9, bty = 'n', lty = c(1, 2), legend = c("Distribution estimate", "Point estimate"))

par(mar = c(5, 0, 2.5, 0.5))

plot(res_iv_uncertain,
     xlab = 'Number of data points manipulated',
     ylab = '',
     main = 'DECREASE-IV',
     ylim = 0:1,
     yaxt = 'n',
     type = 'l',
     lty = 1)
lines(res_iv_certain, pch = 2, type = 'l',
      lty = 2)
abline(h = c(.025, .975), lty = 3)

par(mar = c(4, 5, 0.5, 0))

plot(x = NA, y = NA,
     xlim = c(0,1), ylim = c(0, 100),
     xlab = "Confidence in %", ylab = "% of data points manipulated")

lines(x = seq(0, 1, .01), y = (res_i_uncertain_lb / N_I) * 100)
lines(x = seq(0, 1, .01), y = (res_i_uncertain_ub / N_I) * 100)
lines(x = seq(0, 1, .01), y = (res_i_certain_lb / N_I) * 100, lty = 2, pch = 2, type = 'l')
lines(x = seq(0, 1, .01), y = (res_i_certain_ub / N_I) * 100, lty = 2, pch = 2, type = 'l')
abline(v = .95, lty = 3)

# clip(x1 = 0, x2 = length(res_i_uncertain), y1 = 0.025, y2 = .975)
# abline(v = which(abs(res_i_uncertain - .975) == min(abs(res_i_uncertain - .975))), lty = 1)
# abline(v = which(abs(res_i_certain - .975) == min(abs(res_i_certain - .975))), lty = 2)

par(mar = c(4, 0, 0.5, 0.5))

plot(x = NA, y = NA,
     xlim = c(0,1), ylim = c(0, 100),
     xlab = "Confidence in %", ylab = "",
     yaxt = 'n')

lines(x = seq(0, 1, .01), y = (res_iv_uncertain_lb / N_IV) * 100)
lines(x = seq(0, 1, .01), y = (res_iv_uncertain_ub / N_IV) * 100)
lines(x = seq(0, 1, .01), y = (res_iv_certain_lb / N_IV) * 100, lty = 2, pch = 2, type = 'l')
lines(x = seq(0, 1, .01), y = (res_iv_certain_ub / N_IV) * 100, lty = 2, pch = 2, type = 'l')
abline(v = .95, lty = 3)
invisible(dev.off())
```

For DECREASE-I ($N=`r bouri_data$control_n[10] + bouri_data$beta_n[10]`$), the 95\% confidence interval for the estimated number of manipulated data points is [`r which.min(res_i_certain - .025) - 1` - `r which.max(res_i_certain - .975) - 1`] or [`r which.min(res_i_uncertain - .025) - 1` - `r which.max(res_i_uncertain - .975) - 1`] when based on a point estimate or a more uncertain distribution estimate, respectively. The left column of Figure `r fignr` depicts the $p_M$ per *X* manipulated data points (top panel) and the bounds of the confidence interval when the degree of confidence is altered (lower panel). Staying clearly between the dotted lines in the top panel, depicting the 95\% CI (top: .975; bottom: .025), it becomes apparent that the degree of uncertainty is too high to make any reasonable estimates about the number of manipulated data points with sufficient confidence. This is partly due to the small sample size of the DECREASE-I trial (i.e., $N=`r length(res_i_certain) - 1`$) and the availability of just the summary results. Only when the degree of confidence is lowered to around 75\% does the interval not span the entire sample size. As such, based on the summary results, little can be said about the extent of the data manipulation that occurred in the DECREASE-I trial, affirming the conclusions of the original committee report [@commissie2013]. 

```{r figure 3, fig.cap = 'Inversion method results used to estimate the number of data points manipulated in the DECREASE-I and DECREASE-IV trials. The top row panels indicate $p_M$ (y-axis) for all $X$ out of $N$ manipulated data points (x-axis). The bottom row indicates the estimated interval of manipulated data points (y-axis) when varying the degree of confidence (x-axis). Dotted lines indicate the bounds for a 95 percent CI.', out.width = '80%', fig.asp = .5, fig.align = 'center', echo = FALSE}
knitr::include_graphics(sprintf("%sfigures/fig2.pdf", x12))
fignr <- fignr + 1
```

For DECREASE-IV ($N=`r bouri_data$control_n[11] + bouri_data$beta_n[11]`$), the 95\% confidence interval for the estimated number of manipulated data points is [`r which.min(res_iv_certain - .025) - 1` - `r which.max(res_iv_certain - .975) - 1`] or [`r which.min(res_iv_uncertain - .025) - 1` - `r which.max(res_iv_uncertain - .975) - 1`] when based on a point estimate or a more uncertain distribution estimate, respectively. The relatively minor difference between the point- and distribution estimates indicates that there is a high degree of confidence that data manipulation did occur based on the difference of the trial results alone. Nonetheless, the range of potentially manipulated data points is still estimated at approximately 1000; this indicates that the summary results are insufficient to provide more than an estimated lower bound. This indicates that it is possible not all data were manipulated (i.e., $N=`r length(res_iv_certain) - 1`$) but at least some were, increasing the importance of well-documented data provenance to discern between genuine and falsified data. We note that, for reasons unknown to us, the confidence interval of the point estimates are more uncertain than those of the distribution estimates, whereas similar code for DECREASE-I provides the reverse (the code is available for review at https://osf.io/4zs29/).

# Discussion

The effect of beta-blockade on perioperative mortality was already unclear based on the investigations regarding scientific integrity; our results strongly affirm that the empirical evidence from the DECREASE trials is highly discrepant from other trials supposedly studying the same effect (i.e., the effectiveness of beta-blockers in decreasing perioperative mortality). Our results indicate that the results from the DECREASE trials are nearly impossible to have arisen from the same effect inspected by the non-DECREASE trials, except when we assume at least some of the data were manipulated. As such, the scientific validity of the DECREASE-I and DECREASE-IV trials should be regarded as highly problematic and untrustworthy when assessing the effectiveness of beta-blockade on perioperative mortality if they truly investigate the same effects as the non-DECREASE trials, as is often assumed [@bouri2014]. Nonetheless, the original papers that presented these trial results are not yet retracted [@poldermans1999;@dunkelgrun2009], despite the integrity reports [@commissie2011;@commissie2012;@commissie2013].

<!-- Ja onderscheid tussen fabricatie en manipulatie is het discussieren waard. Voor de werenschappelijke waarde vd decrease trials maakt het weinig uit, maar het is wel interessant voor de vraag hoe die rare data van poldermans totstand gekomen zijn. -->

Our approach to estimating the number of manipulated data points has one major limitation that we would like to highlight: multiplicity. For each estimated proportion of manipulated data points, there is another smaller (or larger) proportion with more (or less) extremely manipulated data points. This problem is similar to how various samples can give rise to the same mean, but contain vastly different individual scores within them (e.g., -2.5 and +2.5 versus -100 and +100; both give the mean zero). Nonetheless, this limitation does still allow us to estimate whether any data manipulation occurred because there is no multiplicity in not manipulating data. 

The ESC/ESA and ACC/AHA guidelines [@Kristensen_2014;@Fleisher_2014] on perioperative beta-blockade already excluded the DECREASE trials in their assessment, but also explicitly states that other trials by Poldermans are excluded. However, upon close inspection of the reference lists, the ACC/AHA guidelines still cites four trials including Poldermans as author as evidence for the guidelines [@Boersma_2001;@poldermans1999;@van_Kuijk_2009;@Flu_2010], of which two were already inspected by the scientific integrity committees of Erasmus MC [@Boersma_2001;@poldermans1999]. In the ACC/AHA guidelines, the following is said about studies conducted by Poldermans: 

> _"If nonretracted DECREASE publications and/or other derivative studies by Poldermans are relevant to the topic, they can only be cited in the text with a comment about the finding compared with the current recommendation but should not form the basis of that recommendation or be used as a reference for the recommendation."_ [@Fleisher_2014]

Nonetheless, references are made without clear comments. Given the confirmation of problems in the DECREASE-I and DECREASE-IV trials in our results, it stresses that there is reason to distrust trials by Poldermans. For the integrity of the guidelines and the safety of the patients, we pose that investigations should be initiated into works where Poldermans was involved and which were not cleared by the scientific committees of Erasmus MC in their misconduct investigations. Especially those papers cited as evidence in the ACC/AHA guidelines should be investigated, considering that they affect patients and their treatment directly.

Previously, further investigation of trials by Poldermans was deemed unfeasible due to the lack of raw data; here we indicate methods that do make it feasible. Based on just event-count data and trials that supposedly investigate the same effect, we were able to estimate whether part of the data were in fact manipulated and whether the results were within reason of trials investigating the same effect. The results clearly indicated they were not such reason.

The results of our analyses also highlight that, despite the lack of availability of the raw data, summary results from larger samples allow for marginally better estimates of the number of manipulated data points when similar trials are available. Larger trials result in relatively more certainty (e.g., DECREASE-IV) about the estimated number of manipulated data points, when using the inversion method, compared to smaller trials (e.g., DECREASE-I). This increased certainty is due to decreased standard errors of the estimated effects, resulting in higher sensitivity to data anomalies. Nonetheless, much residual uncertainty remains and simply less information is available in summary results when compared to raw data, as indicated by the large range of the confidence intervals in Step 3. As such, raw data availability would improve the options open to detect potential anomalies (note: raw data are available for DECREASE VI, but upon a freedom of information request by the first author, Erasmus MC refused to share these data; see [osf.io/fswjt/](https://osf.io/fswjt/)). The results also highlight that in order to prevent detection, it would be in the manipulator's interest to fabricate small and imprecise studies (assuming the manipulator wants to remain undetected), which ultimately detracts from the scientific value of such a study and hence the individual reward for manipulation through reduced impact (hopefully).

With respect to clinical practice, the results provide some tentative evidence that type of beta-blockade can severely influence perioperative mortality. Our reanalysis of the Bouri et al. [@bouri2014] data indicates that type of beta-blockade can reverse the effect on perioperative mortality, even after taking into account whether a study belongs to the DECREASE family. As such, atenolol seems to tentatively decrease perioperative mortality, whereas the others (metoprolol, propranolol, bisoprolol) increase perioperative mortality. However, there seems to be covariation with respect to treatment administration, duration, and dose, which further confounds whether the treatment effect is due to type of beta-blocker or due to one of these other parameters. There are too few studies ($k=11$) too properly discern the various treatments from each other, requiring a new randomized trial with high statistical power to determine moderating factors (if any). This affirms the statement from the ESC/ESA guidelines that _"high priority needs to be given to new randomized clinical trials to better identify which patients derive benefit from beta-blocker therapy in the perioperative setting, and to determine the optimal method of beta-blockade"_ [@Kristensen_2014].

Moreover, the DECREASE and non-DECREASE trials seem to apply beta-blockade from different conceptual viewpoints that could confound the effectiveness of beta-blockade. The non-DECREASE trials seem to focus purely on the application of beta-blockers in itself, whereas the DECREASE trials use beta-blockade as a proxy to decrease resting heart rate [@poldermans1999;@dunkelgrun2009]. As such, the DECREASE studies applied beta-blockade at least a week in advance, specifically in order to lower patient's resting heart rate to <70BPM and potentially habituate the patient to the effects of the beta-blockade. Other studies apply the beta-blockade just prior to the surgery (maximum: one day prior) and therefore seem to regard the treatment specifically and not the proxy of lowered BPM. As such, the differences between the DECREASE and non-DECREASE trials might also in part be a consequence of the different approaches in the various trials. Whether these differences matter in treatment decisions is worthy of further research in a clinical trial with high statistical power to find such differences.

In sum, our research indicates that the DECREASE trials are nearly impossible if we assume they investigate exactly the same effect as the non-DECREASE trials and under that assumption, our results provide some evidence that at least some data points were manipulated. However, these differences might also be due to different conceptual approaches as to how beta-blockade might prevent mortality in non-cardiac surgery. We recommend renewed investigations into Poldermans' work given these findings --- especially those works still referenced by guidelines on the use of beta-blockers without proper notice. Moreover, it remains unclear whether beta-blockers might be effective in preventing mortality rates in non-cardiac surgery patients. Considering this, we recommend new and more extensively controlled, confirmatory trials to determine whether there is any use in administering beta-blockers in order to decrease perioperative mortality --- at the moment there is insufficient evidence to determine any positive effect of beta-blockers on mortality rates.

# Session info

```{r, echo = FALSE}
sessionInfo()
```

# References